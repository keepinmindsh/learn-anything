# 쿠버네티스의 이해

## 쿠버네티스 어원

'쿠버네티스'는 조종사, 조타수(선박의 핸들을 잡고 있는 사람)를 뜻하는 그리스어이다.

## 쿠버네티스와 같은 시스템이 필요한 이유

기존의 모놀리틱한 서비스 구조에서는 수직 확장이 수평확장보다 쉬웠다. 하지만 서비스 간의 도메인 복잡도가 증가하고, 사용자의 사용량이 BtoC로 확장될 경우
수직확장 만으로는 서비스의 부하를 감당하는데는 상당한 부담이 발생할 수 있다.   

모놀리틱한 서비스를 마이크로 서비스나 모듈형으로 분리하는 것은 자원의 효율적인 사용, 서비스의 확장 등을 위해서 필수적인 요소가 되었다. 
여기에서 마이크로 서비스로 개별 도메인단위로 분리된 서비스를 어떻게 하면 동일 환경에서 빠르게 확장하고 테스트하고, 개발할 수 있을 것인가에 대한 고민들로부터 나온 것이 Container 라는 기반 환경이다.   
컨테이너에 해당 서비스가 동작할 수 있는 환경을 구성하여 쉽게 개발, 테스트, 배포가 가능하졌지만, 수십개의 컨테이너를 엔지니어가 일일이 관리 운영하기란 쉽지 않은 문제였다.  
서비스 확장, 네트워크 구성, 로깅, 서비스 간의 영향도 관리 등을 효율적으로 하기 위해서   
Service Orchestrator 로서 역할을 수행할 수 있는 쿠버네티스는 복잡한 도메인으로 구성된 마이크로 서비스와 클라우드 환경에서 필수적인 구성요소로 부각되었다.

- 마이크로서비스 확장
- 마이크로서비스 배포
- 환경 요구 사항의 다양성
- 애플리케이션에 일관된 환경 제공
- 지속적인 배포로 전환

# 쿠버네티스 컴포넌트

![쿠버네티스 컴포넌트](https://kubernetes.io/images/docs/components-of-kubernetes.svg)

## 컨트롤 플레인

클러스터를 제어하고 작동 시킨다. 하나의 마스터 노드에서 실행하거나 여러 노드로 분할되고 복제되어 고가용성을 보장할 수 있는 여러 구성 요소로 구성된다.

- 쿠버 네티스 API 서버는 사용자, 컨트롤 플레인 구성 요소와 통신한다.
- 스케줄러는 애플리케이션의 배포를 담당한다.
- 컨트롤러 매니저는 구성 요소 복제본, 워커 노드 추적, 노드 장애 처리 등과 같은 클러스터 단의 기능을 수행한다.
- Etcd는 클러스터 구성을 지속적으로 저장하는 신뢰할 수 있는 분산 데이터 저장소다.

### 세부 구성 요소

- kube-apiserver: API 서버로, 클러스터의 모든 구성 요소와 통신한다.
- kube-controller-manager: 클러스터 상태를 관리하고, 필요한 작업을 수행하는 컨트롤러를 실행한다.
- kube-scheduler: 클러스터의 워커 노드에 파드를 할당하는 역할을 한다.
- etcd: 클러스터 상태를 저장하는 분산 키-값 저장소로, 모든 클러스터 데이터를 영구적으로 저장한다.
- cloud-controller-manager: 클라우드 서비스 제공업체와 통신하여 클러스터 리소스를 관리한다.

## 워커 노드

실제 배포되는 애플리케이션을 실행한다.

- 컨테이너를 실행하는 도커, rkt 또는 다른 컨테이너 런타임
- API 서버와 통신하고 노드의 컨테이너를 관리하는 Kubelet
- 애플리케이션 구성 요소 간에 네트워크 트래픽을 로드 밸런싱 하는 쿠버네티스 서비스 프록시

### 세부 구성 요소

- kubelet: 각 노드에서 실행되며, API 서버와 통신하고 파드를 관리한다.
- kube-proxy: 네트워크 프록시로, 서비스 간의 트래픽을 라우팅하고 로드 밸런싱을 수행한다.
- 컨테이너 런타임: 컨테이너를 실행하는 소프트웨어로, Docker, containerd, CRI-O 등이 있다.
- kube-dns 또는 CoreDNS: 클러스터 내의 DNS 서비스를 제공하여 서비스 이름을 IP 주소로 변환한다.
- 웹 UI (대시보드) : 대시보드는 쿠버네티스 클러스터를 위한 범용의 웹 기반 UI다. 사용자가 클러스터 자체뿐만 아니라, 클러스터에서 동작하는 애플리케이션에 대한 관리와 문제 해결을 할 수 있도록 해준다.
- 컨테이너 리소스 모니터링 : 컨테이너 리소스 모니터링은 중앙 데이터베이스 내의 컨테이너들에 대한 포괄적인 시계열 매트릭스를 기록하고 그 데이터를 열람하기 위한 UI를 제공해 준다.
- 클러스터-레벨 로깅 : 클러스터-레벨 로깅 메커니즘은 검색/열람 인터페이스와 함께 중앙 로그 저장소에 컨테이너 로그를 저장하는 책임을 진다.

> [출처: 쿠버네티스 공식 문서](https://kubernetes.io/docs/concepts/overview/components/)

# 쿠버네티스 대안 제품

- [Nomad (HashiCorp)](https://developer.hashicorp.com/nomad)
- [Docker Swarm](https://docs.docker.com/engine/swarm/)
- [k3s (Rancher Labs)](https://k3s.io/)
- [MicroK8s (Canonical)](https://microk8s.io/)