# 개략적인 규모 추정 

구글의 시니어 펠로 제프딘에 따르면, "개략적인 규모 추정은 보편적으로 통용되는 성능 수치상에 사고실험을 행하여 추정치를 계산하는 행위로써,   
어떤 설계가 요구사항에 부합할 것인지 보기위한 것" 이다.

# 규모 확장성을 표현하는데 필요한 기본기

- 2의 제곱수 
- 응답지연 값 
- 가용성에 관계된 수치

## 제2의 제곱수 

우리가 흔희 메모리, 대역폭, 저장소 등에서 자주 사용하게 되는데, 각 단위를 표현하면,

| 지수   | 값               | 비고                    |
|------|-----------------|-----------------------|
| 2¹⁰  | 1,024           | 약 1KB (1,000으로 근사)    |
| 2²⁰  | 1,048,576       | 약 1MB                 |
| 2³⁰  | 1,073,741,824   | 약 1GB                 |
| 2⁴⁰  | 약 1TB           |                       |


## 응답 지연값 

```
Latency Comparison Numbers (~2012)
----------------------------------
L1 cache reference                           0.5 ns  
Branch mispredict                            5   ns
L2 cache reference                           7   ns                      14x L1 cache  
Mutex lock/unlock                           25   ns  
Main memory reference                      100   ns                      20x L2 cache, 200x L1 cache  
Compress 1K bytes with Zippy             3,000   ns        3 us  
Send 1K bytes over 1 Gbps network       10,000   ns       10 us
Read 4K randomly from SSD*             150,000   ns      150 us          ~1GB/sec SSD  
Read 1 MB sequentially from memory     250,000   ns      250 us  
Round trip within same datacenter      500,000   ns      500 us
Read 1 MB sequentially from SSD*     1,000,000   ns    1,000 us    1 ms  ~1GB/sec SSD, 4X memory  
Disk seek                           10,000,000   ns   10,000 us   10 ms  20x datacenter roundtrip  
Read 1 MB sequentially from disk    20,000,000   ns   20,000 us   20 ms  80x memory, 20X SSD  
Send packet CA->Netherlands->CA    150,000,000   ns  150,000 us  150 ms
```

```
Notes  
----- 
1 ns = 10^-9 seconds  
1 us = 10^-6 seconds = 1,000 ns  
1 ms = 10^-3 seconds = 1,000 us = 1,000,000 ns
```


### 단위 변환 정리 (시간 기준)
```
ms - μs - ns - ps - fs - as

ms (밀리초 / milli second) : 10⁻³ 초    
μs (마이크로초 / micro second) : 10⁻⁶ 초    
ns (나노초 / nano second) : 10⁻⁹ 초    
ps (피코초 / pico second) : 10⁻¹² 초    
fs (펨토초 / femto second) : 10⁻¹⁵ 초    
as (아토초 / atto second) : 10⁻¹⁸ 초    
```

> https://gist.github.com/jboner/2841832

### 응답 지연에서 중요한 포인트 

- 메모리는 빠르지만 디스크는 아직도 느리다. 
- 디스크 탐색은 가능한 피하라. 
- 단순한 압축 알고리즘은 빠르다.
- 데이터를 인터넷으로 전송하기 전에 압축하라.

## 가용성에 관련된 수치들 

고가용성은 시스템이 오랜 시간 동안 지속적으로 중단없이 운영될 수 있는 능력을 지칭하는 용어다.  

고가용성을 표현하는 값은 퍼센트로 표현하는데 100%는 한번도 중단된 적이 없었음을 의미한다.  

대부분의 서비스는 99% ~ 100% 사이의 값을 갖는다. 

- SLA 
  - 서비스 사업자가 보편으로 사용하는 용어로, 서비스 사업자와 고객 사이에 맺어진 합의를 의미한다.

| SLA 수준          | 가용률 (%)  | 연간 허용 다운타임           | 월간 허용 다운타임       |
|-----------------|----------|----------------------|------------------|
| 100% (이론상)      | 100%     | 0시간                  | 0시간              |
| "Six Nines"     | 99.9999% | 약 52분                | 약 4.4분           |
| "Five Nines"    | 99.999%  | 약 52분                | 약 4.4분           |
| "Four Nines"    | 99.99%   | 약 52분                | 약 4.4분           |
| "Three Nines"   | 99.9%    | 약 8.8시간              | 약 43.8분          |
| "Two Nines"     | 99.0%    | 약 87.6시간 (3.65일)     | 약 7.2시간          |

### 📌 변수 설명 

- **총 가동 시간**: 전체 기간 중 서비스가 정상적으로 운영된 시간
- **총 시간**: 서비스가 제공되어야 하는 전체 시간 (예: 1년 = 365일 × 24시간 = 8,760시간)

### 📘 예시
- 총 시간: 8,760시간 (1년)
- 다운타임: 4시간  
  → 가용률 = ((8760 - 4) / 8760) × 100 = **99.954%**

---

> 💡 참고: SLA 수준에 따라 99.9%, 99.99% 등의 목표 가용률이 설정됩니다.


## 용어 

### QPS ( Qeury Per Second : 초당 질의수 )

"초당 요청 수" 또는 **"초당 질의 수"**를 의미하는 시스템 성능 지표입니다.

### MAU ( Monthly Active User : 월간 활성 사용자 수 )

MAU는 Monthly Active Users의 약자로, 특정 기간(보통 한 달) 동안 서비스(앱이나 웹사이트 등)를 이용한 순수한 사용자 수를 의미합니다. 
즉, 중복 사용자를 제외하고 한 달 동안 한 번이라도 서비스를 이용한 고유 사용자 수를 나타냅니다. 
MAU는 서비스의 인기도와 사용자 참여도를 나타내는 중요한 지표로 사용됩니다. 

### DAU ( Daily Active User : 일간 활성 사용자 수 )

특정 서비스 (웹사이트, 앱 등)를 24시간 동안 이용한 순 사용자 수를 의미합니다. 
주로 서비스의 인기도나 사용자 참여도를 측정하는 지표로 활용됩니다.

## 표로 정리한 용어들

| 용어                                     | 설명                                                         |
|----------------------------------------|------------------------------------------------------------|
| **QPS (Queries Per Second)**           | 초당 요청 수. API 서버나 DB가 1초에 처리해야 할 요청량을 나타냄.                  |
| **Latency (지연 시간)**                    | 요청을 보낸 시점부터 응답을 받기까지 걸리는 시간 (ms 단위).                       |
| **P99 Latency**                        | 99번째 백분위수 응답 시간. 전체 요청 중 가장 느린 1%의 응답 시간.                  |
| **Throughput (처리량)**                   | 단위 시간당 시스템이 처리할 수 있는 데이터 양. 일반적으로 초당 바이트 또는 요청 수로 표현됨.     |
| **TPS (Transactions Per Second)**      | 초당 트랜잭션 수. 주로 DB 트랜잭션이나 금융 시스템에서 사용됨.                      |
| **Concurrency (동시 접속 수)**              | 동시에 처리해야 하는 사용자 수나 세션 수. 서버/시스템의 동시성 처리 능력을 판단하는 기준.       |
| **Availability (가용성)**                 | 시스템이 정상 동작하는 비율. 예: 99.9% 가용성은 연간 약 8.76시간 다운타임 허용.        |
| **RPS (Requests Per Second)**          | QPS와 유사하며, 웹 요청 처리량을 나타냄.                                  |
| **Resource Utilization**               | CPU, Memory, Disk 등의 자원 사용률. 병목 지점 확인에 유용.                 |
| **Capacity Planning**                  | 현재와 미래 수요를 고려한 자원 요구량 예측. 서버 수, 인스턴스 크기 등을 추정할 때 필요.       |
| **Load Factor**                        | 피크 시간 대비 평균 사용량의 비율. 과부하 가능성 판단에 활용.                       |
| **SLA (Service Level Agreement)**      | 서비스가 보장하는 최소 성능 기준. 예: 99.99%의 SLA 보장 등.                   |

## 부하 테스트 링크 도음 

| 도구 이름                      | 설명                                                    | 공식 URL                                                                                                        |
|----------------------------|-------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
| **wrk**                    | 고성능 HTTP 부하 생성 도구 (멀티스레드, 멀티커넥션)                      | [https://github.com/wg/wrk](https://github.com/wg/wrk)                                                        |
| **hey**                    | Go로 작성된 간단한 HTTP 부하 생성기 (Google에서 개발)                 | [https://github.com/rakyll/hey](https://github.com/rakyll/hey)                                                |
| **ab (ApacheBench)**       | Apache HTTP 서버에 기본 포함된 부하 테스트 도구                      | [https://httpd.apache.org/docs/2.4/programs/ab.html](https://httpd.apache.org/docs/2.4/programs/ab.html)      |
| **Locust**                 | Python 기반의 사용자 시뮬레이션 부하 테스트 도구 (UI 지원)                | [https://locust.io/](https://locust.io/)                                                                      |
