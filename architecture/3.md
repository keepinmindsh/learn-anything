# 처리율 제한 장치의 설계 

네트워크 시스템에서 처리율 제한 장치는 클라이너트 또는 서비스가 보내는 트래픽의 처리율을 제어하기 위한 장치이다.  
HTTP로 예를 들면 이 장치는 특정 기간 내에 전송되는 클라이언트의 요청 횟수를 제한한다.  

### 몇가지 사례 

- 사용자는 초당 2회 이상 새 글을 올릴 수 없다. 
- 같은 IP 주소로는 하루에 10개 이상의 계정을 생성할 수 없다. 
- 같은 디바이스로는 주당 5회 이상 리워드를 요청할 수 없다. 
- 트위터는 3시간동안 300개의 트윗만 올릴 수 있다록 제한하고 있다. 
- 구글 독스 API는 사용자당 분당 300회의 READ 요청만 허용한다.
- 처리율 제한은 제 3자 API에 사용료를 지불하고 있는 회사들에게는 아주 중요하다. 
- 서버의 과부하를 막는다. 

## 필요사항 

- 설정된 처리율을 초과하는 요청은 정확하게 제한한다. 
- 낮은 응답시간: 이 처리율 제한 장치는 HTTP 응답 시간에 나쁜 영향을 주어서는 곤란하다. 
- 가능한 한 적은 메모리를 써야 한다. 
- 분산형 처리율 제한: 하나의 처리율 제한 장치를 여러 서버나 프로세스에 공유할 수 있어야 한다. 
- 예외처리: 요청이 제한되었을 때는 그 사실을 사용자에게 분명하게 부여주어야 한다. 
- 높은 결함 감내성: 제한 장치에 장애가 생기더라도 전체 시스템에 영향을 주어서는 안 된다. 

### 처리율 제한 장치의 위치 

- 서버 API
- 서버 API 내의 미들웨어 
- 클라우드 기반의 API Gateway 


### 처리율 제한 알고리즘 

- 토큰 버킷
- 누출 버킷
- 고정 윈도 카운터
- 이동 윈도 로그
- 이동 윈도 카운터